{"cells":[{"source":"\"use strict\";\nvar Engine = BABYLON.Engine,Scene = BABYLON.Scene,ArcRotateCamera = BABYLON.ArcRotateCamera,Vector3 = BABYLON.Vector3,MeshBuilder = BABYLON.MeshBuilder,PBRMaterial = BABYLON.PBRMaterial,PointLight = BABYLON.PointLight,DefaultRenderingPipeline = BABYLON.DefaultRenderingPipeline,SolidParticleSystem = BABYLON.SolidParticleSystem,SSAORenderingPipeline = BABYLON.SSAORenderingPipeline;\nvar canvas = document.querySelector('canvas');\nvar engine = new Engine(canvas);\nvar scene = new Scene(engine);\nscene.clearColor.set(0.1, 0.1, 0.1, 1);\nvar camera = new ArcRotateCamera('', -Math.PI / 2, Math.PI / 2, 250, new Vector3(0, 0, 0), scene);\ncamera.attachControl(canvas);\nvar mat = new PBRMaterial('', scene);\nmat.albedoColor.set(0.1, 0.1, 0.1);\nmat.roughness = 1;\nvar light = new PointLight('', new Vector3(0, 0, 0), scene);\nlight.intensity = 1e5;\nlight.diffuse.set(1, 0.8, 0.9); // mood\nvar rnds = function (a, b) {\n  if (a === void 0) {a = 0;}\n  if (b === void 0) {b = 1;}\n  return (a + Math.random() * (b - a)) * (Math.random() < 0.5 ? -1 : 1);\n};\nvar box = MeshBuilder.CreateBox('', { size: 10 });\nvar sps = new SolidParticleSystem('', scene);\nsps.addShape(box, 2e2);\nvar x = 0,y = 0,z = 0,sx = 1,sy = 1,sz = 1;\nvar TH = 90;\nsps.updateParticle = function (p) {\n  switch (Math.random() * 3 | 0) {\n    case 0: // floor/ceiiing\n    case 1:\n      x = rnds(0, 100);\n      y = rnds(TH, 100);\n      z = rnds(0, 100);\n      sx = 5;\n      sy = 1;\n      sz = Math.random() * 10;\n      break;\n    case 2: // wall\n      x = rnds(0, 50);\n      y = rnds(0, 100);\n      z = Math.random() * 10 + 90;\n      sx = 10;\n      sy = 1;\n      sz = 1;\n      break;}\n\n  ;\n  p.position.set(x, y, z);\n  p.scaling.set(sx, sy, sz);\n  p.rotation.set(0, rnds(0, Math.PI / 10), rnds(0, Math.PI / 10));\n  return p;\n};\nvar spsmesh = sps.buildMesh();\nbox.dispose();\nsps.setParticles();\nspsmesh.material = mat;\nspsmesh.alwaysSelectAsActiveMesh = true;\nvar gem = MeshBuilder.CreatePolyhedron('', { type: 1, sizeY: 10, sizeX: 5, sizeZ: 5 });\nvar gemMat = new PBRMaterial('', scene);\ngemMat.roughness = 0.1;\ngemMat.metallic = 0.4;\ngemMat.emissiveColor = light.diffuse;\ngem.material = gemMat;\ngem.position.z = 40;\ngem.parent = spsmesh;\nvar t = 0;\nscene.onBeforeRenderObservable.add(function () {\n  gem.position.y = Math.sin(t) * 5 + 20;\n  gem.rotation.y = t;\n  spsmesh.rotation.y = Math.sin(t * 0.02) * Math.PI / 3;\n  light.position = gem.position.add(new Vector3(0, 16, 0));\n  t += 0.1;\n  canvas.classList.toggle('hover-gem', scene.meshUnderPointer == gem); // css\n});\nscene.constantlyUpdateMeshUnderPointer = true;\nvar pp = new DefaultRenderingPipeline('');\npp.bloomEnabled = true;\npp.bloomWeight = 0.1;\npp.bloomThreshold = 0.8;\nvar ao = new SSAORenderingPipeline('', scene, { ssaoRatio: 0.8, combineRatio: 1.0 }, [camera]);\nao.radius = 0.0002;\nao.base = 0.7;\nwindow.onresize = function () {return engine.resize();};\nengine.runRenderLoop(function () {return scene.render();});","language":"javascript"},{"source":"canvas {\n  width: 100vw;\n  height: 100vh;\n  display: block;\n}\n.info {\n  position: fixed;\n  top: 0;\n  left: 0;\n  color: #eee;\n  padding: 5vmin;\n}\ncanvas.hover-gem + .info:after {\n  content: 'ðŸ’¡';\n}\n","language":"css"},{"source":"<canvas></canvas><a class=\"info\" href=\"//twitter.com/ycwhk\" target=\"_blank\">Dawn</a>","language":"html"}]}